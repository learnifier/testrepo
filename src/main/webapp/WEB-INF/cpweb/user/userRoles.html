[#ftl strip_text="true" /]


[#import "userOverviewMenu.html" as userMenu]


[#assign cpweb_foot ]
${cpweb_foot}
<script>
$(document).ready(function() {
        var oTable = $('#userroleslist').dataTable({
            "sDom": 'rt<"dataTables_footer clearfix"i>',
            "bPaginate": false,            
            "aaSorting": [[0,'asc']],
            "aoColumnDefs": [
                {
                    "aTargets": [ 0 ],
                    "mData": "name",
                    "fnRender": function ( oObj ) {
                        return  '<span title="' +oObj.aData.name + '">' + cocobox.trunc(oObj.aData.name, 20) + '</span>';
                    }
                },
                {
                    "aTargets": [ 1 ],
                    "mData": null,
                    "sWidth": "10%",
                    "bSortable": false,
                    "fnRender": function ( oObj ) {
                        [#if security.hasPermission("BO_EDIT_USER")]
                          return '<button onclick="deleteMember(\'' +  oObj.aData.uuid +'\')">Delete</button>';
                        [#else]
                          return '';
                        [/#if]
                    }
                }


            ],
                        
            "sAjaxSource": "${helper.urlFor('user.UserJsonModule','listBoRoles',[user.userId?c])}",
             
            "oLanguage": {
                "sEmptyTable": "<span class='emptytable'>${user.displayName?xhtml} has no roles assigned </span>",
                "sLoadingRecords": "<p>Loading roles...</p><img src='${contextPath}/img/spinner-threedots.gif' />"
            }
        });
 
    } );
    
</script>

[/#assign]

[#assign head]
${cpweb_head}
<style>
    #logoform {
        display: block;
        margin: 20px auto;
        padding: 15px; 
    }
    .progress {
        position:relative;
        width:400px;
        border: 1px solid #ddd;
        padding: 1px;
        border-radius: 3px;
        display: none;
    }
    .bar {
        background-color: #B4F5B4;
        width:0%; 
        height:20px;
        border-radius: 3px; 
    }
    .percent {
        position:absolute;
        display:inline-block;
        top:3px;
        left:48%; 
    }
</style>

[/#assign]

[@dws.skin skin="CPAuth2" head=cpweb_head ctxMenu=cpweb_ctxMenu foot=cpweb_foot]

    <section id="userinfo">
        <div id="itemactions">
            [#if role == "clientadmin"]
                <form action="${helper.urlFor('user.CreateUserModule','resendInvitation',[org.id, user.userId])}" method="post">
                    <button>Resend invitation</button>
                </form>
            [/#if]
            <form action="${helper.urlFor('user.CreateUserModule','edit',[org.id, user.userId])}" method="post">
                <button>Edit</button>
            </form>
        </div>
        <div id="usericon">
            [#if userimg??]
            <img src="${userimg}" alt="${user.displayName?xhtml} Profile Image"/>
            [#else]
            <img src="${cocoboxCdn}/cocobox/img/cp/userImage_64x64.png" alt="${user.displayName?xhtml} Profile Image" />
            [/#if]
            <p>User</p><h1>${user.displayName?xhtml}</h1>
        </div>
        <div class="itemdetails">
            <ul>
                <li><span class="label">Email</span><span class="setting clearfix">${user.primaryEmail?xhtml}</span></li>
                <li><span class="label">Language</span><span class="setting clearfix">${locale.getDisplayName(userLocale)?xhtml}</span></li>
                <li><span class="label">Role</span><span class="setting clearfix">[@dws.txt key="cpweb.useroverview." + role!"role_na" /]</span></li>
            </ul>
        </div>
    </section>

    [@userMenu.userOverviewMenu selected="roles"][/@userMenu.userOverviewMenu]
    
    <h2>Roles</h2>
    
    
    [#list roles as role]
    
    ${role}
    
    [/#list]
    
    <section class="list">
        <table class="list" id="userroleslist">
            <thead>
                <tr>
                    <th>Role</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </section>
    
    

[/@dws.skin]

