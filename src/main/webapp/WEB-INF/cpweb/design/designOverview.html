[#ftl strip_text="true" /]

[#macro userNameAndEmail userId]
    [#if infoHelper.getMiniUserInfo(userId)??]
        [#local userInfo =  infoHelper.getMiniUserInfo(userId) /]
        <span data-toggle="tooltip" data-placement="top" title="${userInfo.displayName?xml} &lt;${userInfo.email?xml!''}&gt;">${userInfo.displayName?xml}</span>
    [#else]
        &nbsp;
    [/#if]
[/#macro]

[#assign cpweb_foot ]
${cpweb_foot}
<script>
    $('#tm_materials').addClass('activeItem').prev().addClass('prevItem');
    
    function deleteCourseDesign () {
        cocobox.confirmationDialog("Delete course design", "Do you want to delete this course design?", 
        function() { return true });
    }
    
    $('#deleteBtn').click(function() {
        cocobox.confirmationDialog("Delete course design", "Do you want to delete this course design?", function() { $('#deleteForm').submit(); });
        return false;
  });
</script>

[/#assign]

[@mbform._onreadyJavascript]

    $(function () {
      $('[data-toggle="tooltip"]').tooltip()
    })    

[/@mbform._onreadyJavascript]

[#assign cpweb_head]
${cpweb_head}

[/#assign]

[@dws.skin skin="CPAuth3" head=cpweb_head foot=cpweb_foot orgName=orgName]

<section class="ccb-page-header">
    <div class="ccb-page-header__actions">
            [#if !info.sticky && portalSecurity.hasPermission("CP_DELETE_COURSEDESIGN")]
            <form action="${helper.urlFor('coursedesign.DesignModule','delete',[org.id, designId])}" method="post" id="deleteForm">
                <button type="submit" id="deleteBtn" class="btn btn-primary-outlined"><span class="glyphicon glyphicon-trash"></span> Delete</button>
            </form>
            [/#if]

            [#if !info.sticky && portalSecurity.hasPermission("CP_EDIT_COURSEDESIGN")]
            <form action="${helper.urlFor('coursedesign.DesignModule','editDesign',[org.id, designId])}" method="post">
                <button type="submit" class="btn btn-primary-outlined"><span class="glyphicon glyphicon-pencil"></span> Edit Course Template</button>
            </form>
            [/#if]

            [#if !info.sticky && portalSecurity.hasPermission("CP_EDIT_COURSEDESIGN")]
            <form action="${helper.urlFor('coursedesign.DesignModule','edit',[org.id, designId])}" method="post">
                <button type="submit" class="btn btn-primary-outlined"><span class="glyphicon glyphicon-pencil"></span> Edit Settings</button>
            </form>
            [/#if]

            [@portalSecurity.permissionBlock permission="CP_COPY_COURSEDESIGN"]
            <form action="${helper.urlFor('coursedesign.DesignModule','edit',[org.id, designId,'t'])}" method="post">
                <button type="submit" class="btn btn-primary-outlined"><span class="glyphicon glyphicon-flash"></span> Create copy</button>
            </form>
            [/@]

            <form action="${helper.urlFor('coursedesign.DesignModule','view',[org.id, designId])}" method="post">
                <button type="submit" class="btn btn-primary-outlined"><span class="glyphicon glyphicon-eye-open"></span> View</button>
            </form>
            
             <form action="${helper.urlFor('coursedesign.DesignModule','preview',[org.id, designId])}" method="post" target="_blank">
                <button type="submit" class="btn btn-primary-outlined"><span class="glyphicon glyphicon-eye-open"></span> Preview</button>
            </form>
            
        </div>
        <div class="ccb-page-header__info">
            <img class="page-thumbnail img-circle img-thumbnail" src="http://www.harborfinancialgroup.com/news-views/wp-content/uploads/2013/11/Learning.jpg" />
            <p class="page-title-label">Course Template</p>
            <h1 class="page-title">${design.name?xhtml}</h1>
            <ul class="page-created-updated__wrapper list-inline">
                <li>
                    <p class="page-updated-label">Created</p><p class="page-updated">[@userNameAndEmail design.createdBy /]<span data-toggle="tooltip" data-placement="top" title="${(design.created?datetime?string.full)!''}">${(design.created?date?string.full)!''}</span></p>
                </li>
                <li>
                    <p class="page-updated-label">Updated</p><p class="page-updated">[@userNameAndEmail design.updatedBy /] <span data-toggle="tooltip" data-placement="top" title="${(design.updated?datetime?string.full)!''}">${(design.updated?date?string.full)!''}</span></p>
                </li>
            </ul>
        </div>
        <div class="ccb-page-header__details">
            <ul>
                <li><span class="row-label">Description</span><span class="row-setting">${(design.description!"")?xhtml}</span></li>
                <li><span class="row-label">Origin</span><span class="row-setting">[@dws.txt key="cpweb.designoverview." + info.sticky?string!""  /]</span></li>
                [#if expiration??]
                <li><span class="row-label">Expiration limit</span><span class="row-setting">${expiration!""}</span></li>
                [/#if]
            </ul>
        </div>
    </section>


[/@dws.skin]

