[#ftl strip_text="true" /]

[#import "projectInfo.html" as pInfo /]

[#assign cpweb_head ]
${cpweb_head}

<link rel='stylesheet' type='text/css' href='${cocoboxCdn}/cocobox/css/select2/select2.css'/>
<link rel='stylesheet' type='text/css' href='${cocoboxCdn}/cocobox/css/select2/select2-bootstrap.css'/>
[/#assign]


[#assign cpweb_foot ]
${cpweb_foot}
<script>
    $('#tm_projects').addClass('activeItem').prev().addClass('prevItem');
    
    
    $(document).ready(function() {
       $.ajax({
           url: "${helper.urlFor('project.role.ProjectRoleJsonModule', 'searchUser', [org.id])}",
           success: function(data) {
               log(data);
           }
       });
    });
    
    
    require(['select2.min'], function()Â {
        
       $("#userSelect").select2({
            placeholder: "Search for a user",
            minimumInputLength: 1,
            ajax: { 
                url: "${helper.urlFor('project.role.ProjectRoleJsonModule', 'searchUser', [org.id])}",
                dataType: 'jsonp',
                data: function (term, page) {
                    return {
                        term: term, // search term
                        page_limit: 10
                    };
                },
                results: function (data, page) { // parse the results into the format expected by Select2.
                    // since we are using custom formatting functions we do not need to alter remote JSON data
                    return {results: data.results};
                }
            },
            formatResult: function(data) {
                return data;
            } 
        }); 
    });
    
</script>
[/#assign]

[@dws.skin skin="CPAuth2" head=cpweb_head ctxMenu=cpweb_ctxMenu foot=cpweb_foot orgName=orgName]

[@pInfo.projectInfo selected="overview"][/@pInfo.projectInfo]

<h2>[@dws.txt key="cpweb.project.roles.title" /]</h2>

[#list projectRoles?keys as projectRoleId]
${projectRoleId}: ${projectRoles[projectRoleId]}
    [#-- <a href="${helper.urlFor('project.ProjectJsonModule','assignRole',[prj.projectId, security.userAccount.userId, projectRoleId])}">Assign</a>
    <a href="${helper.urlFor('project.ProjectJsonModule','deleteRole',[prj.projectId, security.userAccount.userId, projectRoleId])}">Revoke</a> --]
    <br/>
[/#list]

<div id="userSelect" class="bigdrop"></div>


[/@dws.skin]

