[#ftl strip_text="true" /]

[#assign cpweb_foot]
${cpweb_foot}

<script id="list-item-template" type="text/x-handlebars-template">
    <a href="#" class="list-group-item">
        <h4 class="list-group-item-heading">{{name}}</h4>
        <p class="list-group-item-text">Added: {{added}} Invited: {{invited}}</p>
    </a>
</script>

<script>
    var projectList = "${cycle.urlFor('CpJsonModule','listOrgProjects',[org.id?c])}";
    var projectListArchived = "${cycle.urlFor('CpJsonModule','listOrgProjects',[org.id?c])}?f=archived";

    require(['handlebars'], function (Handlebars) {
        $.get(projectList)
                .always(function () {
                    $("#spinnerbox").hide();
                })
                .done(function (data) {
                    var tmpl = Handlebars.compile($("#list-item-template").html());

                    var html = $.map(data.aaData, function (obj) {
                        return tmpl(obj);
                    });

                    $("#projectLg").append(html);
                })
                .fail(function () {
                    $("#ajaxErrorBox").toggleClass("hidden");
                });
    });

</script>

[/#assign]

[@dws.skin skin="barebone_bootstrap" head=cpweb_head foot=cpweb_foot]

<div class="container">
    <h1>Select target project</h1>
</div>

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <ul class="nav nav-pills">
                <li role="presentation" class="active"><a href="#">${ctext("listprojects.activeandnew")?xml}</a></li>
                <li role="presentation"><a href="#">${ctext("listprojects.disabled")?xml}</a></li>
            </ul>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <p class="center" id="spinnerbox" style="padding-top: 10px;">[@common.spinner /]</p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div class="alert alert-danger hidden" role="alert" id="ajaxErrorBox">Failed to get data from the server. Please try again later.</div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div id="projectLg" class="list-group">

            </div>
        </div>
    </div>

    [/@dws.skin]
