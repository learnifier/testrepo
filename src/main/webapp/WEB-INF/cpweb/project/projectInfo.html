[#ftl strip_text="true" /]

[#macro projectInfo selected project=prj]

[#assign projectSettingUrl = helper.urlFor('project.ProjectSettingsJsonModule', 'changeSetting',[project.projectId]) /]

[@mbform._onreadyJavascript]

cpweb.editable($('#project-name .editable-content'), $('#project-name .editable-control'), function(value){}, {});
cpweb.editable($('#project-desc .editable-content'), $('#project-desc .editable-control'), function(value){}, {type: 'textarea'});
cpweb.editable($('#project-usertitle .editable-content'), $('#project-usertitle .editable-control'), function(value){});
cpweb.editable($('#project-userdesc .editable-content'), $('#project-userdesc .editable-control'), function(value){}, {type: 'textarea'});

[/@mbform._onreadyJavascript]


[#include "../projectDeleteFailure.html" /]
[#include "error/projectProductError.html" /]


<section id="projectinfo">
    <div id="itemactions">

        [#if !isIdproject() ]
        <form id="deleteprojectform" action="${helper.urlFor('project.ProjectModificationModule','deleteProject',[org.id,project.projectId])}" method="post">
            <button class="delete"><span>Delete</span></button>
        </form>
        [/#if]
        [#if isIdproject() ]
        <form action="${helper.urlFor('project.ProjectModule', 'roster',[project.masterProject])}" method="post">
            <button>Back to parent project</button>
        </form>
        [/#if]
        [@mbform._onreadyJavascript]
        require(['dabox-common'], function() {
        cocobox.ajaxForm("#deleteprojectform", function(data) {
        if (data.location) {
        window.location = data.location;
        } else {
        cocobox.infoDialog('Delete project','You need to delete all participants to be able to delete the project.');
        }
        });
        });
        [/@mbform._onreadyJavascript]
    </div>

    [#if isIdproject() ]

    <div class="itemicon">
        <p>Project</p>
        <h1>${(material.title?xhtml)!'Unknown product'} for ${infoHelper.getUserIdentifier((participationOwner.userId)!0)!''?xhtml}</h1>

        <p>invited by ${infoHelper.getUserIdentifier(project.createdBy)!''?xhtml}

            in ${masterProject.name}</p>

    </div>

    [#else]	

    <div class="itemicon">
        <p>Project</p><h1 id="project-name"><span class="editable-content" data-url="${projectSettingUrl}" data-pk="name">${project.name?xhtml}</span><span class="editable-control">Edit</span></h1>
    </div>

    [/#if]
	
	
	
    [#if project.stageDesignId??]

    <div id="incomplete_dd">
        <h2>Activate Your Updated Course Design</h2>
        <p>Your updated course design <span class="imp">will not be available to participants </span>until you have clicked the button below and entered any required information.</p>

        [#if !prj.invitePossible]
        <p><span class="imp">You cannot invite participants until you have activated the course design.</span></p>
        [/#if]
        <form action="${helper.urlFor('project.VerifyProjectDesignModule','verifyNewDesign',[project.projectId])}" method="post">
            <button type="submit" ><span>Activate Course Design Now</span></button>
        </form>
    </div>
    [/#if]
     <div class="itemdetails">
        <ul>
            <li><span class="label">Note</span><span class="setting clearfix" id="project-desc"><span class="editable-content" data-url="${projectSettingUrl}" data-pk="note">${project.note!""?xhtml}</span><span class="editable-control">Edit</span></span></li>
            [#if project.type.ptype == 2]
                <li><span class="label">Learner Portal Name</span><span class="setting clearfix">${project.displayUserTitle!""?xhtml}</span></li>
            [#else]
                <li><span class="label">Course Name</span><span class="setting clearfix" id="project-usertitle"><span class="editable-content" data-url="${projectSettingUrl}" data-pk="usertitle">${project.displayUserTitle!""?xhtml}</span><span class="editable-control">Edit</span></span></li>
                <li><span class="label">Course Description</span><span class="setting clearfix" id="project-userdesc"><span class="editable-content" data-url="${projectSettingUrl}" data-pk="userdesc">${project.displayUserDescription!""?xhtml}</span><span class="editable-control">Edit</span></span></li>
            [/#if]
        </ul>
    </div>
    <nav id="itemnav">
        <ul>
            [#--    <li class="[#if selected == 'overview']activeItem[/#if]"><a href="${helper.urlFor('ProjectModule','overview',[project.projectId])}"><span>[@dws.txt key='cpweb.projectmenu.overview' /]</span></a></li>--]
            <li class="[#if selected == 'participants']activeItem[/#if]"><a href="${helper.urlFor('ProjectModule','roster',[project.projectId])}"><span>[@dws.txt key='cpweb.projectmenu.participants' /]</span></a></li>

            [#if project.type.ptype == 2 && !isIdproject(prj)]
            <li class="[#if selected == 'details']activeItem[/#if]"><a href="${helper.urlFor('VerifyProjectDesignModule','verifyNewDesignSecondary',[project.projectId])}"><span>[@dws.txt key='cpweb.projectmenu.details' /]</span></a></li>
            [/#if]

            [#if !isIdproject(prj)]
            <li class="[#if selected == 'schedule']activeItem[/#if]"><a href="${helper.urlFor('ProjectModule','task',[project.projectId])}"><span>[@dws.txt key='cpweb.projectmenu.schedule' /]</span></a></li>
            [/#if]
            [#if project.type.ptype == 2 && dwsrt.hasFeature('flirt') ]
            <li class="[#if selected == 'discussion']activeItem[/#if]"><a href="${helper.urlFor('ProjectModule','discussion',[project.projectId])}"><span>[@dws.txt key='cpweb.projectmenu.discussion' /]</span></a></li>
            [/#if]
            
            [#if project.type.ptype == 2]
            <li class="[#if selected == 'design']activeItem[/#if]"><a href="${helper.urlFor('ProjectModule','design',[project.projectId])}"><span>[@dws.txt key='cpweb.projectmenu.design' /]</span></a></li>
            [/#if]
            
            <li class="[#if selected == 'reports']activeItem[/#if]"><a href="${helper.urlFor('ProjectModule','reports',[project.projectId])}"><span>[@dws.txt key='cpweb.projectmenu.reports' /]</span></a></li>
            [#if project.type.ptype == 1 || project.type.ptype == 2]
            <li class="[#if selected == 'materials']activeItem[/#if]"><a href="${helper.urlFor('ProjectModule','materials',[project.projectId])}"><span>[@dws.txt key='cpweb.projectmenu.materials' /]</span></a></li>
            [/#if]
            <li class="[#if selected == 'registration']activeItem[/#if]"><a href="${helper.urlFor('ProjectModule','registration',[project.projectId])}"><span>[@dws.txt key='cpweb.projectmenu.registration' /]</span></a></li>
            <li class="[#if selected == 'settings']activeItem[/#if]"><a href="${helper.urlFor('ProjectModule','settings',[project.projectId])}"><span>[@dws.txt key='cpweb.projectmenu.settings' /]</span></a></li>
        </ul>
    </nav>
</section>


[/#macro]

[#function isIdproject project=prj ]

[#return project.subtype == 'idproject' /]

[/#function]